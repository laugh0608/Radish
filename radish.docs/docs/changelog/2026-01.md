# 2026年1月开发日志

> 萝卜币系统与消息通知系统

本月开发日志已按周分割，请查看：

- [第1周 (1月1日-5日)](./2026-01/week1.md) - Gateway 文档正式化、萝卜币系统 MVP
- [第2周 (1月6日-10日)](./2026-01/week2.md) - 消息通知系统 M7 P1 完成

---

## 月度总结

### 核心成果

**萝卜币系统 MVP**（第1周）：
- ✅ 萝卜币基础服务（余额管理、交易记录、系统赠送）
- ✅ 论坛奖励服务（点赞、评论、神评、沙发奖励）
- ✅ 定时任务（神评沙发统计、保留奖励发放）
- ✅ 前端集成（Toast 组件、余额显示、钱包页面）
- ✅ 注册奖励集成（新用户 50 胡萝卜）
- ✅ 精确计算系统（CoinCalculator，52 个单元测试全通过）

**消息通知系统 M7 P1**（第2周）：
- ✅ SignalR Hub 连接和实时推送（P0 完成）
- ✅ 数据模型和独立消息数据库（Radish.Message.db）
- ✅ NotificationService 核心业务逻辑
- ✅ NotificationCacheService 缓存管理
- ✅ NotificationDedupService 去重服务
- ✅ 点赞和评论通知集成
- ✅ 前端通知中心和列表组件
- ✅ API 接口完整（列表、未读数、标记已读、删除）

**架构优化**：
- ✅ BaseRepository 泛型聚合方法（QueryDistinctAsync、QuerySumAsync）
- ✅ 开发规范文档精简（CLAUDE.md -66%，节省约 35,000 tokens）
- ✅ 强化分层架构约束（Service 层禁止直接访问 Db 实例）
- ✅ 独立消息数据库架构（性能隔离、架构解耦）

**文档优化**：
- ✅ Gateway 文档从规划转为正式技术文档
- ✅ 消息通知系统文档更新（4个文档，移除过时内容）
- ✅ 更新开发计划和日志

**认证功能**：
- ✅ 用户注册功能完善
- ✅ 注册页面视图
- ✅ 安全优化（移除默认测试账号）

**前端体验**：
- ✅ 修复用户头像显示问题
- ✅ 论坛窗口化窄宽时折叠左右分栏
- ✅ Toast 通知组件（@radish/ui）
- ✅ 通知中心应用（独立窗口应用）

### 技术亮点

1. **萝卜币精确计算**：所有交易以整数为单位，统一向下取整，记录舍入差额
2. **消息通知实时推送**：SignalR WebSocket 实时推送，替代轮询机制
3. **通知去重与缓存**：5分钟去重窗口，30分钟缓存过期，提升性能
4. **数据库级聚合**：通过 BaseRepository 泛型方法避免内存过滤，提升性能
5. **独立消息数据库**：通知系统独立数据库，性能隔离和架构解耦
6. **文档质量提升**：基于实际代码实现，包含大量实用示例

---

查看详细日志请点击上方链接。
