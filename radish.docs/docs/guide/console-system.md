# Console 管理后台系统设计方案

> 版本：v1.0 | 最后更新：2026-01-16 | 状态：开发中

## 拆分说明

Console 管理后台系统文档较长，为便于阅读已拆分为多篇文档；章节编号保持不变。

## 文档导航

- [2. 核心概念](/guide/console-core-concepts) - 角色定位、权限模型、设计原则
- [3. 功能模块](/guide/console-modules) - 仪表盘、应用管理、用户管理、角色管理、系统监控
- [4. 技术架构](/guide/console-architecture) - 前端架构、认证集成、API 设计
- [5. 实施计划](/guide/console-roadmap) - 分阶段开发、验收标准

---

## 1. 系统概述

Console 管理后台是 Radish 社区的统一管理平台，面向系统管理员提供用户管理、应用管理、权限控制、系统监控等核心功能。系统设计遵循"安全可靠、易用高效"的原则，为管理员提供专业的管理工具，同时确保系统的安全性和稳定性。

### 1.1 核心设计原则

- **安全性**：基于 OIDC 的统一认证，细粒度的权限控制，操作审计日志
- **易用性**：清晰的导航结构，直观的操作界面，完善的提示反馈
- **可维护性**：模块化的代码组织，统一的 UI 组件库，规范的开发流程
- **可扩展性**：插件化的功能模块，灵活的权限配置，支持功能动态扩展

### 1.2 业务边界

**当前已实现**：
- ✅ OIDC 统一认证登录
- ✅ 应用管理（OIDC 客户端 CRUD）
- ✅ 基础布局框架（侧边栏、顶栏、内容区）
- ✅ Hangfire 定时任务监控（iframe 集成）

**规划实现**：
- 📋 用户管理（用户列表、详情、状态管理）
- 📋 角色管理（角色 CRUD、权限分配）
- 📋 权限管理（资源定义、权限矩阵）
- 📋 系统监控（服务状态、性能指标、日志查询）
- 📋 操作审计（管理员操作日志、敏感操作追踪）
- 📋 系统配置（全局配置、功能开关）

**暂不实现**：
- ❌ 内容审核（帖子、评论审核，由专门的审核系统处理）
- ❌ 数据分析（BI 报表，由专门的数据平台处理）
- ❌ 财务管理（萝卜币充值、提现，由财务系统处理）

### 1.3 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Console 管理后台架构                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    前端展示层                         │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────┐ │   │
│  │  │ 仪表盘   │  │ 应用管理 │  │ 用户管理 │  │ 监控 │ │   │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────┘ │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐           │   │
│  │  │ 角色管理 │  │ 权限管理 │  │ 审计日志 │           │   │
│  │  └──────────┘  └──────────┘  └──────────┘           │   │
│  └─────────────────────────────────────────────────────┘   │
│                            │                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                  认证与授权层                         │   │
│  │  ┌──────────────────┐  ┌──────────────────┐         │   │
│  │  │ OIDC 认证        │  │ 权限验证中间件    │         │   │
│  │  │ (Radish.Auth)    │  │ (API Gateway)    │         │   │
│  │  └──────────────────┘  └──────────────────┘         │   │
│  └─────────────────────────────────────────────────────┘   │
│                            │                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    业务服务层                         │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌───────────┐  │   │
│  │  │ UserService  │  │ RoleService  │  │ AuditLog  │  │   │
│  │  │  用户管理     │  │  角色管理     │  │  审计日志  │  │   │
│  │  └──────────────┘  └──────────────┘  └───────────┘  │   │
│  │  ┌──────────────┐  ┌──────────────┐                 │   │
│  │  │ClientService │  │SystemMonitor │                 │   │
│  │  │  应用管理     │  │  系统监控     │                 │   │
│  │  └──────────────┘  └──────────────┘                 │   │
│  └─────────────────────────────────────────────────────┘   │
│                            │                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    数据存储层                         │   │
│  │  User │ Role │ Permission │ OidcClient │ AuditLog    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 1.4 核心业务流程

#### 管理员登录流程
```
访问 Console (/console/)
       ↓
检查登录状态 → 未登录 → 跳转 OIDC 登录页
       ↓
输入用户名密码 → Auth Server 验证
       ↓
验证成功 → 返回授权码 (code)
       ↓
Console 回调页面 (/console/callback)
       ↓
使用 code 换取 access_token
       ↓
保存 token 到 localStorage
       ↓
跳转到 Console 首页 (仪表盘)
```

#### 应用管理流程
```
管理员进入应用管理页面
       ↓
查看应用列表 → 加载 OIDC 客户端列表
       ↓
       ├── 新增应用 → 填写表单 → 创建客户端 → 返回 Client Secret
       ├── 编辑应用 → 修改配置 → 更新客户端
       ├── 重置密钥 → 确认操作 → 生成新密钥 → 返回新 Secret
       └── 删除应用 → 二次确认 → 删除客户端
```

### 1.5 与现有系统集成

| 系统 | 集成点 | 说明 |
|------|--------|------|
| Radish.Auth | OIDC 认证 | 统一登录、Single Sign-Out |
| Radish.Gateway | API 网关 | 统一入口、权限验证、路由转发 |
| Radish.Api | 业务 API | 用户、角色、权限等业务接口 |
| Hangfire | 定时任务 | iframe 嵌入 Hangfire Dashboard |

### 1.6 访问方式

**开发环境**：
- 直接访问：`http://localhost:3100` (开发服务器)
- 通过 Gateway：`https://localhost:5000/console/` (推荐)

**生产环境**：
- 统一入口：`https://yourdomain.com/console/` (通过 Gateway)

---

## 相关文档

- [认证系统设计](/guide/authentication) - OIDC 认证流程
- [网关配置](/guide/gateway) - Gateway 路由配置
- [前端开发指南](/frontend/development) - 前端开发规范
- [UI 组件库](/frontend/ui-library) - @radish/ui 组件使用
- [开发计划](/development-plan) - 里程碑规划

---

> 本文档随 Console 系统开发持续更新，如有变更请同步修改 [更新日志](/changelog/)。
