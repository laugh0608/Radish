{
  // ============================================================
  // Radish.Gateway - 服务网关配置
  // ============================================================
  // 说明：本配置适用于开发和生产环境
  //       生产环境部署时，建议通过环境变量覆盖以下配置：
  //       - GatewayService__PublicUrl (公开访问域名)
  //       - Cors__AllowedOrigins__0 (前端域名)
  // ============================================================

  // 日志配置
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },

  "AllowedHosts": "*",

  // CORS 配置
  // 开发环境：本地前端地址
  // 生产环境：通过环境变量添加实际域名
  "Cors": {
    "AllowedOrigins": [
      "http://localhost:3000",
      "https://localhost:3000",
      "http://localhost:3200",
      "https://localhost:3200"
    ]
  },

  // Gateway 公开访问地址（用于门户页面展示）
  // 开发：https://localhost:5000
  // 生产：通过环境变量设置为 https://your-domain.com
  "GatewayService": {
    "PublicUrl": "https://localhost:5000"
  },

  // 下游服务配置（内部服务地址）
  // 开发环境：localhost + 端口
  // 生产环境（Docker/K8s）：容器名/服务名 + 端口
  "DownstreamServices": {
    "ApiService": {
      "BaseUrl": "http://localhost:5100",
      "HealthCheckPath": "/health"
    },
    "AuthService": {
      "BaseUrl": "http://localhost:5200",
      "HealthCheckPath": "/health"
    }
  },

  // 前端服务配置（用于门户页面展示）
  // 生产环境通过环境变量设置
  "FrontendService": {
    "BaseUrl": "http://localhost:3000"
  },

  // YARP 反向代理配置
  // 路由和集群配置适用于开发和生产环境
  "ReverseProxy": {
    "Routes": {
      // 文档服务路由
      "docs-route": {
        "ClusterId": "docs-cluster",
        "Match": {
          "Path": "/docs/{**catch-all}"
        }
      },
      // API 路由
      "api-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/api/{**catch-all}"
        }
      },
      // 上传文件静态资源路由
      "uploads-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/uploads/{**catch-all}"
        }
      },
      // Scalar API 文档路由
      "scalar-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/scalar/{**catch-all}"
        }
      },
      // OpenAPI 路由
      "openapi-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/openapi/{**catch-all}"
        }
      },
      // Hangfire Dashboard 路由
      "hangfire-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/hangfire/{**catch-all}"
        }
      },
      // SignalR Hub 路由（通知系统）
      "hub-notification-route": {
        "ClusterId": "api-cluster",
        "Match": {
          "Path": "/hub/notification/{**catch-all}"
        },
        "Transforms": [
          // 支持 WebSocket
          { "RequestHeaderOriginalHost": "true" }
        ]
      },
      // 管理控制台路由
      "console-route": {
        "ClusterId": "console-cluster",
        "Match": {
          "Path": "/console/{**catch-all}"
        },
        "Transforms": [
          // 将 /console/* 转发到下游 /，同时由 Console 的 Vite base('/console/') 生成正确的资源路径
          { "PathRemovePrefix": "/console" },
          // 支持 WebSocket (Vite HMR)
          { "RequestHeaderOriginalHost": "true" }
        ]
      },
      // 认证服务 - 账户路由
      "auth-account-route": {
        "ClusterId": "auth-cluster",
        "Match": {
          "Path": "/Account/{**catch-all}"
        },
        "Transforms": [
          { "RequestHeader": "X-Forwarded-Host", "Set": "{host}" },
          { "RequestHeader": "X-Forwarded-Proto", "Set": "{scheme}" },
          { "RequestHeader": "X-Forwarded-For", "Append": "{RemoteIpAddress}" }
        ]
      },
      // 认证服务 - OAuth/OIDC 连接路由
      "auth-connect-route": {
        "ClusterId": "auth-cluster",
        "Match": {
          "Path": "/connect/{**catch-all}"
        },
        "Transforms": [
          { "RequestHeader": "X-Forwarded-Host", "Set": "{host}" },
          { "RequestHeader": "X-Forwarded-Proto", "Set": "{scheme}" },
          { "RequestHeader": "X-Forwarded-For", "Append": "{RemoteIpAddress}" }
        ]
      },
      // 前端根路由（最低优先级，匹配所有其他未匹配的路径）
      "frontend-root": {
        "ClusterId": "frontend-cluster",
        "Match": {
          "Path": "/{**catch-all}"
        },
        "Order": 1000,
        "Transforms": [
          // 支持 WebSocket (Vite HMR)
          { "RequestHeaderOriginalHost": "true" }
        ]
      }
    },
    "Clusters": {
      "docs-cluster": {
        "Destinations": {
          "docs": {
            "Address": "http://localhost:3100"
          }
        }
      },
      "api-cluster": {
        "Destinations": {
          "api": {
            "Address": "http://localhost:5100"
          }
        }
      },
      "auth-cluster": {
        "Destinations": {
          "auth": {
            "Address": "http://localhost:5200"
          }
        }
      },
      "frontend-cluster": {
        "Destinations": {
          "frontend": {
            "Address": "http://localhost:3000"
          }
        }
      },
      "console-cluster": {
        "Destinations": {
          "console": {
            "Address": "http://localhost:3200"
          }
        }
      }
    }
  },

  // 在线文档配置
  "Docs": {
    "Enabled": true,
    "RequestPath": "/docs/"
    //"StaticFolder": "DocsSite"
  }
}



